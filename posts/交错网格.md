# 交错网格与离散化

## 1. 计算域离散化

为了进行数值模拟，我们需要将连续的物理空间离散化。

*   **网格生成**：将正方形计算域划分为 $N_x \times N_y$ 个矩形单元。
*   **网格步长**：$\Delta x = L_x / N_x$ 和 $\Delta y = L_y / N_y$。
*   **坐标索引**：网格点 $(i,j)$ 对应物理坐标 $(x_i, y_j)$，其中 $x_i = i \cdot \Delta x$，$y_j = j \cdot \Delta y$。

### 同位网格 vs 交错网格

*   **同位网格 (Collocated Grid)**：速度分量 $u, v$ 和压力 $p$ 都定义在同一个网格节点上。实现简单，但在处理压力梯度时容易产生非物理的“棋盘格压力”振荡。
*   **交错网格 (Staggered Grid)**：
    *   压力 $p$ 定义在单元中心。
    *   水平速度 $u$ 定义在单元的左右界面（$i \pm 1/2$）。
    *   垂直速度 $v$ 定义在单元的上下界面（$j \pm 1/2$）。
    *   这种布局天然耦合了压力和速度，增强了数值稳定性。

*本求解器为简化教学演示，基础推导基于同位网格思想，但采用了类似交错网格的稳定性处理策略。*

---

## 2. 数值稳定性与精度

在使用显式有限差分法时，时间步长 $\Delta t$ 和网格尺寸不能随意选取，必须满足特定的稳定性条件。

### 2.1 CFL 条件 (Courant-Friedrichs-Lewy)

这是对流项稳定性的限制条件，意味着流体在一个时间步内移动的距离不应超过一个网格单元：

$$
CFL = \max\left(\frac{|u|\Delta t}{\Delta x}, \frac{|v|\Delta t}{\Delta y}\right) \le C_{max} \quad (\text{通常 } C_{max} \approx 1)
$$

### 2.2 扩散数条件

这是粘性扩散项的稳定性限制：

$$
D = \frac{1}{Re} \left( \frac{\Delta t}{(\Delta x)^2} + \frac{\Delta t}{(\Delta y)^2} \right) \le D_{max} \quad (\text{通常 } D_{max} \approx 0.25)
$$

### 2.3 网格雷诺数

$$
Re_{\Delta x} = \frac{u \Delta x}{\nu}
$$
如果网格雷诺数过大（网格太粗），中心差分格式可能会导致解出现数值振荡。此时需要加密网格或采用迎风格式（Upwind Scheme）。

## 3. 精度分析

有限差分格式的精度主要取决于泰勒展开截断项的阶数。
*   **空间精度**：中心差分通常具有二阶精度 $\mathcal{O}(\Delta x^2)$。这意味着网格加密一倍，误差减小约四倍。
*   **时间精度**：一阶向前欧拉格式具有一阶精度 $\mathcal{O}(\Delta t)$。
