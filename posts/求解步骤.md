# 有限差分法与投影法求解

## 1. 有限差分基础

有限差分法（FDM）的核心思想是利用泰勒级数展开，将偏导数近似为代数差分。

### 1.1 泰勒展开

函数 $u(x)$ 在 $x$ 附近的展开：
$$
u(x+\Delta x) = u(x) + \Delta x \frac{\partial u}{\partial x} + \frac{\Delta x^2}{2} \frac{\partial^2 u}{\partial x^2} + \mathcal{O}(\Delta x^3)
$$
$$
u(x-\Delta x) = u(x) - \Delta x \frac{\partial u}{\partial x} + \frac{\Delta x^2}{2} \frac{\partial^2 u}{\partial x^2} - \mathcal{O}(\Delta x^3)
$$

### 1.2 常用差分格式

*   **一阶导数（中心差分）**:
    $$
    \frac{\partial u}{\partial x} \Big|_{i,j} \approx \frac{u_{i+1,j} - u_{i-1,j}}{2\Delta x} \quad \text{精度: } \mathcal{O}(\Delta x^2)
    $$

*   **二阶导数（中心差分）**:
    $$
    \frac{\partial^2 u}{\partial x^2} \Big|_{i,j} \approx \frac{u_{i+1,j} - 2u_{i,j} + u_{i-1,j}}{(\Delta x)^2} \quad \text{精度: } \mathcal{O}(\Delta x^2)
    $$

*   **时间导数（向前差分）**:
    $$
    \frac{\partial u}{\partial t} \approx \frac{u^{n+1} - u^{n}}{\Delta t} \quad \text{精度: } \mathcal{O}(\Delta t)
    $$

---

## 2. 求解算法：投影法 (Projection Method)

由于不可压缩 N-S 方程中没有压力的显式演化方程，且需满足连续性约束 $\nabla \cdot \mathbf{u} = 0$，我们通常采用 **Chorin (1968)** 提出的投影法（或分步法）。

### 第一步：计算中间速度场 $\mathbf{u}^*$

忽略压力梯度项，仅利用对流项和扩散项计算一个临时的预测速度场 $(u^*, v^*)$：

$$
\frac{u^* - u^n}{\Delta t} = - \left( u\frac{\partial u}{\partial x} + v\frac{\partial u}{\partial y} \right)^n + \frac{1}{Re}\nabla^2 u^n
$$

此时的 $\mathbf{u}^*$ 虽然满足动量守恒，但不满足连续性方程（即 $\nabla \cdot \mathbf{u}^* \neq 0$）。

### 第二步：求解压力泊松方程 (PPE)

我们希望通过压力梯度项修正 $u^*$ 得到最终速度 $u^{n+1}$：
$$
\frac{\mathbf{u}^{n+1} - \mathbf{u}^*}{\Delta t} = -\nabla p^{n+1}
$$

对上式两边取散度，并强制要求 $\nabla \cdot \mathbf{u}^{n+1} = 0$（连续性条件），可导出**压力泊松方程**：

$$
\nabla^2 p^{n+1} = \frac{\partial^2 p}{\partial x^2} + \frac{\partial^2 p}{\partial y^2} = \frac{1}{\Delta t} \left( \frac{\partial u^*}{\partial x} + \frac{\partial v^*}{\partial y} \right)
$$

这是一个椭圆型偏微分方程。右端项是中间速度场的散度，代表了流场中的“质量源/汇”。

### 第三步：速度修正

解出压力 $p^{n+1}$ 后，将其代回修正公式更新速度：

$$
u^{n+1}_{i,j} = u^*_{i,j} - \Delta t \frac{p_{i+1,j} - p_{i-1,j}}{2\Delta x}
$$
$$
v^{n+1}_{i,j} = v^*_{i,j} - \Delta t \frac{p_{i,j+1} - p_{i,j-1}}{2\Delta y}
$$

---

## 3. 压力的迭代求解

压力泊松方程通常通过迭代法求解。离散后的形式如下（令 $dx=dy=h$）：

$$
p_{i,j} = \frac{1}{4} \left( p_{i+1,j} + p_{i-1,j} + p_{i,j+1} + p_{i,j-1} - h^2 \cdot b_{i,j} \right)
$$

其中 $b_{i,j}$ 是源项。常用的迭代方法包括：
1.  **Jacobi 迭代**：简单但收敛慢。
2.  **Gauss-Seidel 迭代**：利用当前步已更新的值，收敛较快。
3.  **SOR (超松弛迭代)**：引入松弛因子 $\omega$ (1 < $\omega$ < 2) 加速收敛，是本求解器采用的方法。
